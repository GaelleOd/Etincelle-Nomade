<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planning - √âtincelle Nomade</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- FullCalendar et jQuery -->
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@3.2.0/dist/fullcalendar.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.1/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.2.0/dist/fullcalendar.min.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    
    <style>
        #calendar {
            max-width: 1200px;
            margin: 0 auto;
            background-color: #f9f2eb;
            padding: 20px;
            border: 2px solid #883e2a;
            border-radius: 10px;
        }

        /* Infobulle au survol (agrandie) */
        .tooltip {
            position: absolute;
            background:  #f9f2eb;
            color: #000000;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
            display: none;
            max-width: 300px;
            font-size: 20px;
            font-family: "DMSans VariableFont opsz", wght;
            z-index: 1000;
            transition: opacity 0.2s ease-in-out;
        }

        /* Bo√Æte d'infobulle au clic */
        .event-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background:  #f9f2eb;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
            z-index: 1050;
            display: none;
            width: 350px;
            text-align: center;
        }

        .event-modal h2 {
            color: #883e2a;
            font-size: 50px;
        }

        .event-modal p {
            font-size: 25px;
            font-family: "DMSans VariableFont opsz", wght;
            margin: 10px 0;
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 1049;
        }

        .close-btn {
            margin-top: 10px;
            padding: 10px 15px;
            background: #883e2a;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        
        /* Changer la police des noms des jours (Lundi, Mardi...) */
.fc-day-header {
    font-family: "DMSans VariableFont opsz", wght;
    font-size: 20px;
    color: #883e2a; /* Changer la couleur si besoin */
}

/* Changer la police du nom du mois et du titre */
.fc-center h2 {
    font-family: "DMSans VariableFont opsz", wght;
    font-size: 28px;
    color: #883e2a;
}
/* Augmenter la hauteur des √©v√©nements */
.fc-event {
    min-height: 40px !important; /* Augmente la hauteur */
    line-height: 40px !important; /* Centre le texte verticalement */
    padding: 1px; /* Ajoute de l‚Äôespace autour du texte */
    font-size: 15px; /* Augmente la taille du texte */
    font-family: "DMSans VariableFont opsz", wght;
    text-align: center;
}
.fc-event .fc-title {
    white-space: normal !important; /* Permet au texte de passer √† la ligne */
    font-size: 16px; /* Ajuste la taille du texte */
}

    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <a href="index.html">
                <img src="images/logo.png" alt="Logo √âtincelle Nomade">
                </a>
            </div>
            <div class="site-title">
                <h1>√âtincelle Nomade</h1>
            </div>
            <nav>
                <ul>
                    <li><a href="index.html" class="active">Accueil</a></li>
                    <li><a href="Planning.html">Planning</a></li>
                    <li><a href="qui-suis-je.html">Qui suis-je ?</a></li>
                    <li><a href="contact.html">Contact</a></li>
                </ul>
            </nav>
            <div class="header-icons">
                <a href="https://www.instagram.com/etincellenomadeyoga/" target="_blank">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path d="M 35.75 14 C 15.579 14 14 15.579 14 35.75 L 14 36.25 C 14 56.421 15.579 58 35.75 58 L 36.25 58 C 56.421 58 58 56.421 58 36.25 L 58 35.75 C 58 15.579 56.421 14 36.25 14 L 35.75 14 z M 30 22 L 42 22 C 49.419 22 50 22.581 50 30 L 50 42 C 50 49.419 49.419 50 42 50 L 30 50 C 22.581 50 22 49.419 22 42 L 22 30 C 22 22.581 22.581 22 30 22 z M 45.496094 25 C 44.668094 25.002 43.998 25.674906 44 26.503906 C 44.002 27.331906 44.674906 28.002 45.503906 28 C 46.331906 27.998 47.002 27.325094 47 26.496094 C 46.998 25.668094 46.325094 24.998 45.496094 25 z M 35.976562 26 C 30.454563 26.013 25.987 30.501437 26 36.023438 C 26.013 41.545437 30.501437 46.013 36.023438 46 C 41.545437 45.987 46.013 41.498562 46 35.976562 C 45.987 30.454563 41.498562 25.987 35.976562 26 z M 35.990234 32 C 38.199234 31.995 39.994 33.781234 40 35.990234 C 40.005 38.199234 38.218766 39.995 36.009766 40 C 33.800766 40.005 32.006 38.218766 32 36.009766 C 31.995 33.800766 33.781234 32.006 35.990234 32 z"></path></svg></a>

                <a href="https://www.facebook.com/EtincelleNomadeYoga" target="_blank">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path d="M 29.5 14 C 15.125 14 14 15.125 14 29.5 L 14 42.5 C 14 56.875 15.125 58 29.5 58 L 42.5 58 C 56.875 58 58 56.875 58 42.5 L 58 29.5 C 58 15.125 56.875 14 42.5 14 L 29.5 14 z M 26 22 L 46 22 C 49.71 22 50 22.29 50 26 L 50 46 C 50 49.71 49.71 50 46 50 L 40.644531 50 L 40.644531 42.064453 L 45.023438 42.064453 L 45.679688 36.845703 L 40.642578 36.845703 L 40.642578 33.189453 C 40.642578 31.741453 41.622109 30.998047 42.662109 30.998047 C 43.702109 30.998047 45.855469 30.970703 45.855469 30.970703 L 45.855469 26.298828 C 45.855469 26.298828 43.938422 26.078125 41.982422 26.078125 C 40.337422 26.078125 38.528125 26.54025 37.078125 28.03125 C 35.603125 29.54725 35.390625 31.785578 35.390625 34.517578 L 35.390625 36.845703 L 31 36.845703 L 31 42.064453 L 35.390625 42.064453 L 35.390625 50 L 26 50 C 22.29 50 22 49.71 22 46 L 22 26 C 22 22.29 22.29 22 26 22 z"></path></svg></a>
           
                </div>
        </div>
    </header>
    <main>
        <div id="calendar"></div>
        <div id="tooltip" class="tooltip"></div>
        <div class="modal-overlay"></div>
        <div class="event-modal">
            <h2 id="modal-title"></h2>
            <p><strong>üìÖ Horaire :</strong> <span id="modal-time"></span></p>
            <p><strong>üìç Lieu :</strong> <span id="modal-location"></span></p>
            <p><strong>üìù Description :</strong> <span id="modal-description"></span></p>
            <button class="close-btn">Fermer</button>
        </div>
    </main>

    <script>
        const API_KEY = 'AIzaSyB7Qrzpa8AyAyd0HvccnUg6eyi7AZnYOXA';
        const CALENDAR_ID = '0050746f629df9304b858786fa1a4045542a189da1c74904ce272aac22c91c27@group.calendar.google.com';

        function loadCalendarAPI() {
            gapi.client.setApiKey(API_KEY);
            gapi.client.load('calendar', 'v3', function () {
                fetchEvents();
            });
        }

        function fetchEvents() {
    const request = gapi.client.calendar.events.list({
        calendarId: CALENDAR_ID,
        timeMin: new Date().toISOString(),
        showDeleted: false,
        singleEvents: true,
        orderBy: 'startTime',
    });

    request.execute(function (response) {
        console.log(response); // V√©rification de la r√©ponse de l'API

        if (response.items) {
            const events = response.items.map(event => {
                console.log(event);  // V√©rification de chaque √©v√©nement

                // V√©rifie si l'√©v√©nement a un colorId et utilise la couleur correspondante
                const colorId = event.colorId ? event.colorId : null;
                const backgroundColor = colorId ? getColorFromGoogle(colorId) : "#883e2a"; // Couleur par d√©faut si colorId est manquant

                return {
                    title: event.summary,
                    start: event.start.dateTime || event.start.date,
                    end: event.end.dateTime || event.end.date,
                    description: event.description || "Pas de description",
                    location: event.location || "Lieu non sp√©cifi√©",
                    backgroundColor: backgroundColor,
                    textColor: "white",
                    allDay: event.start.date ? true : false
                };
            });

            renderCalendar(events);
        }
    });
        }

        function renderCalendar(events) {
    $('#calendar').fullCalendar({
        events: events,
        header: {
            left: 'prev,next today',
            center: 'title',
        },
        timeFormat: 'HH:mm', // Format d'heure 24h
        eventRender: function (event, element) {
            let tooltip = $('#tooltip');

            element.on('mouseenter', function (e) {
                tooltip.html(`
                    <strong>${event.title}</strong><br>
                    üìÖ ${formatEventTime(event)}<br>
                    üìç ${event.location}<br>
                    üìù ${event.description}
                `);
                tooltip.css({ top: e.pageY + 15, left: e.pageX + 15 }).fadeIn(200);
            }).on('mouseleave', function () {
                tooltip.hide();
            });

            element.on('click', function () {
                $('#modal-title').text(event.title);
                $('#modal-time').text(formatEventTime(event));
                $('#modal-location').text(event.location);
                $('#modal-description').text(event.description);

                $('.modal-overlay, .event-modal').fadeIn(200);
            });
        }
    });

    $('.modal-overlay, .close-btn').on('click', function () {
        $('.modal-overlay, .event-modal').fadeOut(200);
    });

        }

        function formatEventTime(event) {
    if (event.allDay) {
        return moment(event.start).format("DD/MM/YYYY");
    } else {
        return `${moment(event.start).format("HH:mm")} - ${moment(event.end).format("HH:mm")}`;
    }
}


function getColorFromGoogle(colorId) {
    const googleColors = {
        "1": "#a4bdfc", // Bleu clair
        "2": "#7ae7bf", // Vert clair
        "3": "#dbadff", // Violet clair
        "4": "#ff887c", // Rouge clair
        "5": "#fbd75b", // Jaune clair
        "6": "#ffb878", // Orange clair
        "7": "#46d6db", // Bleu turquoise
        "8": "#e1e1e1", // Gris
        "9": "#5484ed", // Bleu fonc√©
        "10": "#51b749", // Vert fonc√©
        "11": "#dc2127"  // Rouge fonc√©
    };

    return googleColors[colorId] || "#883e2a"; // Si aucune couleur n'est d√©finie, retourne la couleur par d√©faut (#883e2a)
}

        gapi.load('client:auth2', loadCalendarAPI);
    </script>
</body>
</html>
